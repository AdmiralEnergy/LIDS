# COMPASS Development Prompt for Replit

## What This App Is

**COMPASS** = Cognitive Operations Management & Performance Assistance System for Sales

COMPASS is a sales rep AI assistant that connects reps to their personal FieldOps AI agent. It's Admiral Energy's Human-AI collaboration tool - agents are **partners**, not tools.

## Architecture Overview

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  COMPASS (React + Vite)                                                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚  FRONTEND                                                                    â”‚
â”‚  â”œâ”€â”€ AgentIntro: 3D Spline greeting animation (3-5s)                        â”‚
â”‚  â”œâ”€â”€ ChatInterface: Conversational UI with agent                            â”‚
â”‚  â”œâ”€â”€ SuggestedActions: Guided response buttons                              â”‚
â”‚  â”œâ”€â”€ EnrichButton: Trigger lead enrichment                                  â”‚
â”‚  â””â”€â”€ EnrichmentSummary: Show property data results                          â”‚
â”‚                                                                              â”‚
â”‚  BACKEND CONNECTIONS (via Vite proxy)                                        â”‚
â”‚  â”œâ”€â”€ Twenty CRM (3001) â†’ Lead CRUD, notes                                   â”‚
â”‚  â”œâ”€â”€ FieldOps Agents (5001-5010) â†’ Direct chat                              â”‚
â”‚  â””â”€â”€ Agent-Claude (4110) â†’ Complex task fallback                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Current State

This is a **new app**. Start from scratch with Vite + React + TypeScript.

## PRIORITY: Build Phase 0 + Phase 1

### Phase 0: Agent Partner Foundation

Create the core agent chat experience.

#### 1. Agent Client (`src/lib/compass/agent-client.ts`)

```typescript
// Hybrid connection: direct to FieldOps first, Agent-Claude fallback

interface AgentResponse {
  message: string;
  suggestedActions?: SuggestedAction[];
  enrichmentData?: EnrichmentResult;
}

interface SuggestedAction {
  id: string;
  label: string;
  action: string;  // Action type: 'add_note', 'update_status', etc.
  params: Record<string, any>;
  destructive?: boolean;
}

const AGENT_PORTS: Record<string, number> = {
  'fo-001': 5001,
  'fo-002': 5002,
  'fo-003': 5003,
  'fo-004': 5004,
  'fo-005': 5005,
  'fo-010': 5010,
};

export async function sendToAgent(
  agentId: string,
  message: string,
  context: { leadId?: string; callSid?: string }
): Promise<AgentResponse> {
  const port = AGENT_PORTS[agentId] || 5001;

  // Try direct connection first (fast path)
  try {
    const response = await fetch(`/api/agent/${agentId}/chat`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ message, context })
    });
    if (!response.ok) throw new Error('Direct failed');
    return response.json();
  } catch (error) {
    // Fallback to Agent-Claude (complex path)
    const response = await fetch('/api/agent-claude/delegate', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        taskDescription: message,
        targetAgent: agentId,
        context
      })
    });
    return response.json();
  }
}
```

#### 2. useAgentChat Hook (`src/hooks/useAgentChat.ts`)

```typescript
import { useState, useCallback } from 'react';
import { sendToAgent, AgentResponse } from '../lib/compass/agent-client';

interface ChatMessage {
  id: string;
  role: 'user' | 'agent';
  content: string;
  suggestedActions?: SuggestedAction[];
  timestamp: Date;
}

export function useAgentChat(agentId: string, leadId?: string) {
  const [messages, setMessages] = useState<ChatMessage[]>([]);
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const sendMessage = useCallback(async (content: string) => {
    setIsLoading(true);
    setError(null);

    // Add user message
    const userMessage: ChatMessage = {
      id: crypto.randomUUID(),
      role: 'user',
      content,
      timestamp: new Date()
    };
    setMessages(prev => [...prev, userMessage]);

    try {
      const response = await sendToAgent(agentId, content, { leadId });

      // Add agent response
      const agentMessage: ChatMessage = {
        id: crypto.randomUUID(),
        role: 'agent',
        content: response.message,
        suggestedActions: response.suggestedActions,
        timestamp: new Date()
      };
      setMessages(prev => [...prev, agentMessage]);

      return response;
    } catch (err) {
      setError('Failed to connect to agent');
      throw err;
    } finally {
      setIsLoading(false);
    }
  }, [agentId, leadId]);

  return { messages, sendMessage, isLoading, error };
}
```

#### 3. ChatInterface Component (`src/components/ChatInterface.tsx`)

```tsx
import { useState, useRef, useEffect } from 'react';
import { useAgentChat } from '../hooks/useAgentChat';
import { AgentAvatar } from './AgentAvatar';
import { SuggestedActions } from './SuggestedActions';

interface ChatInterfaceProps {
  agentId: string;
  leadId?: string;
  onActionExecute?: (action: SuggestedAction) => Promise<void>;
}

export function ChatInterface({ agentId, leadId, onActionExecute }: ChatInterfaceProps) {
  const { messages, sendMessage, isLoading } = useAgentChat(agentId, leadId);
  const [input, setInput] = useState('');
  const messagesEndRef = useRef<HTMLDivElement>(null);

  useEffect(() => {
    messagesEndRef.current?.scrollIntoView({ behavior: 'smooth' });
  }, [messages]);

  const handleSubmit = async (e: React.FormEvent) => {
    e.preventDefault();
    if (!input.trim() || isLoading) return;

    const message = input;
    setInput('');
    await sendMessage(message);
  };

  return (
    <div className="flex flex-col h-full bg-gray-900 rounded-lg">
      {/* Messages */}
      <div className="flex-1 overflow-y-auto p-4 space-y-4">
        {messages.map(msg => (
          <div key={msg.id} className={`flex ${msg.role === 'user' ? 'justify-end' : 'justify-start'}`}>
            {msg.role === 'agent' && <AgentAvatar agentId={agentId} size="sm" />}
            <div className={`max-w-[80%] rounded-lg p-3 ${
              msg.role === 'user' ? 'bg-blue-600 text-white' : 'bg-gray-700 text-gray-100'
            }`}>
              <p>{msg.content}</p>
              {msg.suggestedActions && (
                <SuggestedActions actions={msg.suggestedActions} onExecute={onActionExecute} />
              )}
            </div>
          </div>
        ))}
        {isLoading && (
          <div className="flex justify-start">
            <AgentAvatar agentId={agentId} size="sm" />
            <div className="bg-gray-700 rounded-lg p-3 text-gray-400">
              Thinking...
            </div>
          </div>
        )}
        <div ref={messagesEndRef} />
      </div>

      {/* Input */}
      <form onSubmit={handleSubmit} className="border-t border-gray-700 p-4">
        <div className="flex gap-2">
          <input
            type="text"
            value={input}
            onChange={e => setInput(e.target.value)}
            placeholder="Type a message or command..."
            className="flex-1 bg-gray-800 text-white rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500"
            disabled={isLoading}
          />
          <button
            type="submit"
            disabled={isLoading || !input.trim()}
            className="bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 disabled:opacity-50"
          >
            Send
          </button>
        </div>
      </form>
    </div>
  );
}
```

#### 4. AgentAvatar Component (`src/components/AgentAvatar.tsx`)

```tsx
interface AgentAvatarProps {
  agentId: string;
  size?: 'sm' | 'md' | 'lg';
}

const AGENT_NAMES: Record<string, string> = {
  'fo-001': 'SCOUT',
  'fo-002': 'ANALYST',
  'fo-003': 'CALLER',
  'fo-004': 'SCRIBE',
  'fo-005': 'WATCHMAN',
  'fo-010': 'APEX',
};

export function AgentAvatar({ agentId, size = 'md' }: AgentAvatarProps) {
  const sizeClasses = {
    sm: 'w-8 h-8',
    md: 'w-12 h-12',
    lg: 'w-16 h-16'
  };

  return (
    <img
      src={`/avatars/${agentId}.png`}
      alt={AGENT_NAMES[agentId] || 'Agent'}
      className={`${sizeClasses[size]} rounded-full object-cover mr-2`}
      onError={(e) => {
        e.currentTarget.src = '/avatars/default.png';
      }}
    />
  );
}
```

#### 5. SuggestedActions Component (`src/components/SuggestedActions.tsx`)

```tsx
interface SuggestedAction {
  id: string;
  label: string;
  action: string;
  params: Record<string, any>;
  destructive?: boolean;
}

interface SuggestedActionsProps {
  actions: SuggestedAction[];
  onExecute?: (action: SuggestedAction) => Promise<void>;
}

export function SuggestedActions({ actions, onExecute }: SuggestedActionsProps) {
  const handleClick = async (action: SuggestedAction) => {
    if (onExecute) {
      await onExecute(action);
    }
  };

  return (
    <div className="mt-3 flex flex-wrap gap-2">
      {actions.map((action, index) => (
        <button
          key={action.id}
          onClick={() => handleClick(action)}
          className={`px-3 py-1 rounded text-sm ${
            action.destructive
              ? 'bg-red-600 hover:bg-red-700 text-white'
              : 'bg-blue-500 hover:bg-blue-600 text-white'
          }`}
        >
          {index + 1}. {action.label}
        </button>
      ))}
    </div>
  );
}
```

### Phase 1: Lead Enrichment (PRIORITY)

The killer feature - agent fills missing lead data.

#### 1. Utility Provider Database (`src/lib/compass/enrichment/utilities.ts`)

```typescript
export interface UtilityProvider {
  id: string;
  name: string;
  ratePerKwh: number;
  avgMonthlyUsage: number;
}

export const NC_UTILITIES: Record<string, UtilityProvider> = {
  duke_progress: {
    id: 'duke_progress',
    name: 'Duke Energy Progress',
    ratePerKwh: 0.11,
    avgMonthlyUsage: 1100
  },
  duke_carolinas: {
    id: 'duke_carolinas',
    name: 'Duke Energy Carolinas',
    ratePerKwh: 0.115,
    avgMonthlyUsage: 1050
  },
  dominion: {
    id: 'dominion',
    name: 'Dominion Energy',
    ratePerKwh: 0.12,
    avgMonthlyUsage: 1000
  }
};

// NC zip prefixes to utility mapping
const ZIP_PREFIX_TO_UTILITY: Record<string, string> = {
  '280': 'duke_carolinas',  // Charlotte
  '281': 'duke_carolinas',
  '282': 'duke_carolinas',
  '283': 'duke_carolinas',
  '276': 'duke_progress',   // Raleigh
  '277': 'duke_progress',
  '278': 'dominion',        // NE NC
  '279': 'dominion',
};

export function lookupUtility(zip: string): UtilityProvider {
  const prefix = zip.substring(0, 3);
  const utilityId = ZIP_PREFIX_TO_UTILITY[prefix] || 'duke_progress';
  return NC_UTILITIES[utilityId];
}
```

#### 2. Calculations (`src/lib/compass/enrichment/calculations.ts`)

```typescript
import { UtilityProvider } from './utilities';

// NC county average price per sqft
const NC_PRICE_PER_SQFT: Record<string, number> = {
  mecklenburg: 220,  // Charlotte
  wake: 210,          // Raleigh
  durham: 200,
  guilford: 160,      // Greensboro
  forsyth: 155,       // Winston-Salem
  cabarrus: 180,      // Concord
  union: 190,         // Monroe
  default: 180
};

export function calculateEstimatedValue(sqft: number, county?: string): number {
  const pricePerSqft = county
    ? NC_PRICE_PER_SQFT[county.toLowerCase()] || NC_PRICE_PER_SQFT.default
    : NC_PRICE_PER_SQFT.default;

  return Math.round(sqft * pricePerSqft);
}

export function calculateElectricBill(sqft: number, utility: UtilityProvider): number {
  // Formula: (sqft / 1000) * 900 kWh * rate
  const kwhPerThousandSqft = 900;
  const monthlyKwh = (sqft / 1000) * kwhPerThousandSqft;
  return Math.round(monthlyKwh * utility.ratePerKwh);
}

export function calculateEstimatedEquity(
  estimatedValue: number,
  mortgageBalance?: number
): number | null {
  if (mortgageBalance == null) return null;
  return estimatedValue - mortgageBalance;
}
```

#### 3. Property Scraper Service (`src/lib/compass/enrichment/property-service.ts`)

```typescript
// This calls the backend API which handles Zillow scraping

export interface PropertyData {
  address: string;
  sqft: number | null;
  yearBuilt: number | null;
  propertyType: string | null;
  estimatedValue: number | null;
  roofType: string | null;
  lotSize: string | null;
  bedrooms: number | null;
  bathrooms: number | null;
}

export async function fetchPropertyData(
  address: string,
  city: string,
  state: string,
  zip: string
): Promise<PropertyData> {
  const response = await fetch('/api/property/lookup', {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ address, city, state, zip })
  });

  if (!response.ok) {
    throw new Error('Property lookup failed');
  }

  return response.json();
}
```

#### 4. Enrich Lead Function (`src/lib/compass/enrichment/enrich-lead.ts`)

```typescript
import { fetchPropertyData, PropertyData } from './property-service';
import { lookupUtility, UtilityProvider } from './utilities';
import { calculateEstimatedValue, calculateElectricBill, calculateEstimatedEquity } from './calculations';

export interface EnrichmentResult {
  property: PropertyData;
  utility: UtilityProvider;
  calculations: {
    estimatedValue: number;
    monthlyElectricBill: number;
    estimatedEquity: number | null;
  };
  source: 'scraped' | 'calculated';
}

export interface Lead {
  id: string;
  address: string;
  city: string;
  state: string;
  zip: string;
  county?: string;
  mortgageBalance?: number;
}

export async function enrichLead(lead: Lead): Promise<EnrichmentResult> {
  // 1. Fetch property data (from Zillow/Redfin via backend)
  const property = await fetchPropertyData(
    lead.address,
    lead.city,
    lead.state,
    lead.zip
  );

  // 2. Look up utility provider
  const utility = lookupUtility(lead.zip);

  // 3. Calculate estimates
  const sqft = property.sqft || 2000; // Default if not found
  const estimatedValue = property.estimatedValue || calculateEstimatedValue(sqft, lead.county);
  const monthlyElectricBill = calculateElectricBill(sqft, utility);
  const estimatedEquity = calculateEstimatedEquity(estimatedValue, lead.mortgageBalance);

  return {
    property,
    utility,
    calculations: {
      estimatedValue,
      monthlyElectricBill,
      estimatedEquity
    },
    source: property.estimatedValue ? 'scraped' : 'calculated'
  };
}

// Save enrichment to Twenty CRM
export async function saveEnrichmentToCRM(leadId: string, result: EnrichmentResult): Promise<void> {
  await fetch(`/api/twenty/people/${leadId}`, {
    method: 'PATCH',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      c_propertyType: result.property.propertyType,
      c_estimatedValue: result.calculations.estimatedValue,
      c_yearBuilt: result.property.yearBuilt,
      c_squareFeet: result.property.sqft,
      c_roofType: result.property.roofType,
      c_utilityProvider: result.utility.name,
      c_monthlyElectricBill: result.calculations.monthlyElectricBill,
      c_estimatedEquity: result.calculations.estimatedEquity
    })
  });
}
```

#### 5. EnrichButton Component (`src/components/EnrichButton.tsx`)

```tsx
import { useState } from 'react';
import { enrichLead, saveEnrichmentToCRM, Lead, EnrichmentResult } from '../lib/compass/enrichment/enrich-lead';

interface EnrichButtonProps {
  lead: Lead;
  onComplete?: (result: EnrichmentResult) => void;
}

export function EnrichButton({ lead, onComplete }: EnrichButtonProps) {
  const [isLoading, setIsLoading] = useState(false);
  const [error, setError] = useState<string | null>(null);

  const handleEnrich = async () => {
    setIsLoading(true);
    setError(null);

    try {
      // 1. Enrich lead
      const result = await enrichLead(lead);

      // 2. Save to CRM
      await saveEnrichmentToCRM(lead.id, result);

      // 3. Notify parent
      onComplete?.(result);
    } catch (err) {
      setError('Failed to enrich lead');
      console.error(err);
    } finally {
      setIsLoading(false);
    }
  };

  return (
    <button
      onClick={handleEnrich}
      disabled={isLoading}
      className="flex items-center gap-2 bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg disabled:opacity-50"
    >
      {isLoading ? (
        <>
          <span className="animate-spin">â³</span>
          Enriching...
        </>
      ) : (
        <>
          <span>ğŸ”</span>
          Enrich Lead
        </>
      )}
    </button>
  );
}
```

#### 6. EnrichmentSummary Component (`src/components/EnrichmentSummary.tsx`)

```tsx
import { EnrichmentResult } from '../lib/compass/enrichment/enrich-lead';

interface EnrichmentSummaryProps {
  result: EnrichmentResult;
}

export function EnrichmentSummary({ result }: EnrichmentSummaryProps) {
  const { property, utility, calculations } = result;

  return (
    <div className="bg-gray-800 rounded-lg p-4 text-white">
      <h3 className="text-lg font-semibold mb-3 text-green-400">
        âœ“ Lead Enriched
      </h3>

      <div className="grid grid-cols-2 gap-3 text-sm">
        {/* Property Info */}
        <div className="flex items-center gap-2">
          <span>ğŸ“</span>
          <span>{property.sqft?.toLocaleString() || 'N/A'} sqft</span>
        </div>

        <div className="flex items-center gap-2">
          <span>ğŸ—ï¸</span>
          <span>Built {property.yearBuilt || 'N/A'}</span>
        </div>

        <div className="flex items-center gap-2">
          <span>ğŸ </span>
          <span>{property.propertyType || 'Single Family'}</span>
        </div>

        {property.roofType && (
          <div className="flex items-center gap-2">
            <span>ğŸ”¨</span>
            <span>{property.roofType} roof</span>
          </div>
        )}

        {/* Financial */}
        <div className="flex items-center gap-2 col-span-2 mt-2 pt-2 border-t border-gray-700">
          <span>ğŸ’°</span>
          <span>Est. Value: ${calculations.estimatedValue.toLocaleString()}</span>
          <span className="text-xs text-gray-400">
            ({result.source === 'scraped' ? 'Zillow' : 'Calculated'})
          </span>
        </div>

        {/* Utility */}
        <div className="flex items-center gap-2 col-span-2">
          <span>âš¡</span>
          <span>{utility.name} | Est. Bill: ${calculations.monthlyElectricBill}/mo</span>
        </div>
      </div>

      <p className="text-xs text-gray-400 mt-3">
        All data saved to CRM
      </p>
    </div>
  );
}
```

### Vite Configuration

```typescript
// vite.config.ts
import { defineConfig } from 'vite';
import react from '@vitejs/plugin-react';

export default defineConfig({
  plugins: [react()],
  server: {
    proxy: {
      '/api/twenty': {
        target: 'http://192.168.1.23:3001',
        changeOrigin: true,
        rewrite: (path) => path.replace(/^\/api\/twenty/, '/rest'),
      },
      '/api/agent': {
        target: 'http://192.168.1.23',
        changeOrigin: true,
        configure: (proxy, options) => {
          // Route to correct agent port based on URL
          proxy.on('proxyReq', (proxyReq, req) => {
            const match = req.url?.match(/\/api\/agent\/(fo-\d+)/);
            if (match) {
              const agentId = match[1];
              const ports: Record<string, number> = {
                'fo-001': 5001, 'fo-002': 5002, 'fo-003': 5003,
                'fo-004': 5004, 'fo-005': 5005, 'fo-010': 5010
              };
              // Note: In real implementation, use http-proxy-middleware with router
            }
          });
        },
      },
      '/api/agent-claude': {
        target: 'http://192.168.1.23:4110',
        changeOrigin: true,
        rewrite: (path) => path.replace(/^\/api\/agent-claude/, ''),
      },
      '/api/property': {
        target: 'http://192.168.1.23:4110',
        changeOrigin: true,
      },
    },
  },
});
```

## File Structure

```
compass-app/
â”œâ”€â”€ package.json
â”œâ”€â”€ vite.config.ts
â”œâ”€â”€ index.html
â”œâ”€â”€ tailwind.config.js
â”œâ”€â”€ postcss.config.js
â”‚
â”œâ”€â”€ public/
â”‚   â”œâ”€â”€ avatars/
â”‚   â”‚   â”œâ”€â”€ fo-001.png
â”‚   â”‚   â”œâ”€â”€ fo-002.png
â”‚   â”‚   â”œâ”€â”€ fo-003.png
â”‚   â”‚   â”œâ”€â”€ fo-004.png
â”‚   â”‚   â”œâ”€â”€ fo-005.png
â”‚   â”‚   â”œâ”€â”€ fo-010.png
â”‚   â”‚   â””â”€â”€ default.png
â”‚   â””â”€â”€ spline/              # Phase 2 (later)
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ main.tsx
â”‚   â”œâ”€â”€ App.tsx
â”‚   â”œâ”€â”€ index.css            # Tailwind imports
â”‚   â”‚
â”‚   â”œâ”€â”€ components/
â”‚   â”‚   â”œâ”€â”€ ChatInterface.tsx
â”‚   â”‚   â”œâ”€â”€ AgentAvatar.tsx
â”‚   â”‚   â”œâ”€â”€ SuggestedActions.tsx
â”‚   â”‚   â”œâ”€â”€ EnrichButton.tsx
â”‚   â”‚   â”œâ”€â”€ EnrichmentSummary.tsx
â”‚   â”‚   â””â”€â”€ CompassPanel.tsx     # Main container
â”‚   â”‚
â”‚   â”œâ”€â”€ hooks/
â”‚   â”‚   â””â”€â”€ useAgentChat.ts
â”‚   â”‚
â”‚   â”œâ”€â”€ lib/compass/
â”‚   â”‚   â”œâ”€â”€ agent-client.ts
â”‚   â”‚   â””â”€â”€ enrichment/
â”‚   â”‚       â”œâ”€â”€ utilities.ts
â”‚   â”‚       â”œâ”€â”€ calculations.ts
â”‚   â”‚       â”œâ”€â”€ property-service.ts
â”‚   â”‚       â””â”€â”€ enrich-lead.ts
â”‚   â”‚
â”‚   â””â”€â”€ types/
â”‚       â””â”€â”€ compass.ts
```

## Main App Component

```tsx
// src/App.tsx
import { useState } from 'react';
import { CompassPanel } from './components/CompassPanel';

export default function App() {
  const [agentId] = useState('fo-001');  // From env or user config
  const [currentLead, setCurrentLead] = useState<Lead | null>(null);

  // Mock lead for testing
  const mockLead = {
    id: 'lead-123',
    address: '123 Main St',
    city: 'Charlotte',
    state: 'NC',
    zip: '28205',
    county: 'Mecklenburg'
  };

  return (
    <div className="min-h-screen bg-gray-950 text-white p-4">
      <h1 className="text-2xl font-bold mb-4">COMPASS</h1>
      <CompassPanel
        agentId={agentId}
        lead={mockLead}
      />
    </div>
  );
}
```

```tsx
// src/components/CompassPanel.tsx
import { useState } from 'react';
import { ChatInterface } from './ChatInterface';
import { AgentAvatar } from './AgentAvatar';
import { EnrichButton } from './EnrichButton';
import { EnrichmentSummary } from './EnrichmentSummary';
import { EnrichmentResult } from '../lib/compass/enrichment/enrich-lead';

interface CompassPanelProps {
  agentId: string;
  lead?: Lead;
}

export function CompassPanel({ agentId, lead }: CompassPanelProps) {
  const [enrichmentResult, setEnrichmentResult] = useState<EnrichmentResult | null>(null);

  return (
    <div className="flex flex-col h-[600px] bg-gray-900 rounded-xl overflow-hidden">
      {/* Header */}
      <div className="flex items-center gap-3 p-4 border-b border-gray-700">
        <AgentAvatar agentId={agentId} size="md" />
        <div>
          <h2 className="font-semibold">Your Agent Partner</h2>
          <p className="text-sm text-gray-400">{agentId.toUpperCase()}</p>
        </div>
        {lead && (
          <div className="ml-auto">
            <EnrichButton lead={lead} onComplete={setEnrichmentResult} />
          </div>
        )}
      </div>

      {/* Enrichment Result */}
      {enrichmentResult && (
        <div className="p-4 border-b border-gray-700">
          <EnrichmentSummary result={enrichmentResult} />
        </div>
      )}

      {/* Chat */}
      <div className="flex-1 overflow-hidden">
        <ChatInterface
          agentId={agentId}
          leadId={lead?.id}
          onActionExecute={async (action) => {
            console.log('Executing action:', action);
            // Handle action execution
          }}
        />
      </div>
    </div>
  );
}
```

## Dependencies (package.json)

```json
{
  "name": "compass-app",
  "private": true,
  "version": "0.1.0",
  "type": "module",
  "scripts": {
    "dev": "vite",
    "build": "tsc && vite build",
    "preview": "vite preview"
  },
  "dependencies": {
    "react": "^18.2.0",
    "react-dom": "^18.2.0"
  },
  "devDependencies": {
    "@types/react": "^18.2.0",
    "@types/react-dom": "^18.2.0",
    "@vitejs/plugin-react": "^4.2.0",
    "autoprefixer": "^10.4.16",
    "postcss": "^8.4.32",
    "tailwindcss": "^3.3.6",
    "typescript": "^5.3.0",
    "vite": "^5.0.0"
  }
}
```

## Success Criteria for Phase 0 + 1

1. **Chat works:** Rep can send messages, agent responds
2. **Avatars display:** Agent avatar shows with fallback
3. **Suggested actions:** Agent can suggest actions, rep can click to execute
4. **Enrich button:** Clicking triggers property lookup
5. **Enrichment summary:** Shows property data after enrichment
6. **CRM save:** Enriched data saves to Twenty CRM

## Don't Do (This Phase)

- Don't add Spline animations (Phase 2)
- Don't add call analysis (Phase 4-5)
- Don't add CRM command parsing (Phase 3)
- Don't add offline storage (Phase 6)
- Keep it simple - agent chat + lead enrichment only

## Environment Variables

```
VITE_AGENT_ID=fo-001
VITE_TWENTY_API_URL=http://192.168.1.23:3001
```
